{{- if and (or .Params.editPost.URL site.Params.editPost.URL) (not (.Param "editPost.disabled")) -}}
<!-- {{- $fileUrlPath := path.Join .File.Path }} -->

  {{- /* 新增开关逻辑 */ -}}
  {{- $removeMDExt := default true (default .Params.editPost.removeMDExtension site.Params.editPost.removeMDExtension) -}}
  {{- $filePath := .File.Path -}}
  {{- $dir := path.Dir $filePath -}}
  {{- $base := path.Base $filePath -}}
  
  {{- /* 根据开关处理扩展名 */ -}}
  {{- if $removeMDExt -}}
    {{- $base = $base | strings.TrimSuffix ".md" -}}
  {{- end -}}

  {{- $fileUrlPath := path.Join $dir $base -}}

{{- if or .Params.author site.Params.author (.Param "ShowReadingTime") (not .Date.IsZero) .IsTranslated }}&nbsp;|&nbsp;{{- end -}}
<a href="{{ .Params.editPost.URL | default site.Params.editPost.URL }}{{ if .Params.editPost.appendFilePath | default ( site.Params.editPost.appendFilePath | default false ) }}/{{ $fileUrlPath }}{{ end }}" rel="noopener noreferrer" target="_blank">
    {{- .Params.editPost.Text | default (site.Params.editPost.Text | default (i18n "edit_post" | default "Edit")) -}}
</a>
{{- end }}
